<UserControl x:Class="KP_4_PuppyHouse1.Pagess.SchedulePage"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
       xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
       mc:Ignorable="d" 
       d:DesignHeight="550" Width="1200">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
            <TextBlock Text="Расписание мастеров" FontSize="24" FontWeight="Bold" Margin="0 0 20 0"/>
            <ComboBox x:Name="MasterComboBox" Width="150" Margin="0 0 10 0" ItemsSource="{Binding Masters}" DisplayMemberPath="FIO" SelectedItem="{Binding SelectedMaster}" Style="{StaticResource ComboBoxFlatStyle}" Height="27" SelectionChanged="MasterComboBox_SelectionChanged"/>
            <ComboBox x:Name="ServiceComboBox" Width="150" Margin="0 0 10 0" ItemsSource="{Binding Status}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedService}" Style="{StaticResource ComboBoxFlatStyle}" Height="26" SelectionChanged="ServiceComboBox_SelectionChanged"/>
            <DatePicker x:Name="StartDatePicker" Width="150" Margin="0 0 10 0" SelectedDate="{Binding StartDate}" Height="25" SelectedDateChanged="StartDatePicker_SelectedDateChanged" />
            <DatePicker x:Name="EndDatePicker" Width="150" Margin="0 0 10 0" SelectedDate="{Binding EndDate}" Height="25" SelectedDateChanged="EndDatePicker_SelectedDateChanged" />
            <Button Content="Отменить" Width="63" Style="{StaticResource addButton}" Margin="0,0,0,0" Background="#FFE09797" Foreground="White" Click="Button_Click_1"/>
            <Button x:Name="AddShedule_Btn" Content="Добавить запись" Width="127" Height="35" Command="{Binding AddRecordCommand}" Style="{StaticResource addButton}" Click="Button_Click" Margin="10,0,0,0"/>
            <Button x:Name="Oplata_Btn" Content="💰" Width="56" Height="35" Command="{Binding AddRecordCommand}" Style="{StaticResource addButton3}" Click="Oplata_Click" Margin="10,0,0,0"/>
        </StackPanel>

        <ListBox x:Name="ScheduleItemsControl" 
         Grid.Row="1" 
         ItemsSource="{Binding ScheduleEntries}" 
         SelectedItem="{Binding SelectedScheduleEntry, Mode=TwoWay}" 
         d:ItemsSource="{d:SampleData ItemCount=10}"
         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
         ScrollViewer.VerticalScrollBarVisibility="Auto">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel Orientation="Horizontal" Width="Auto"/>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Margin="10" Padding="10" Width="260">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="White"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding StatusNote.Name}" Value="Занято">
                                        <Setter Property="Background" Value="#f69f95"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding StatusNote.Name}" Value="Выполнено">
                                        <Setter Property="Background" Value="#ffe2a6"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding StatusNote.Name}" Value="Оплачено">
                                        <Setter Property="Background" Value="#aec289"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                                <RowDefinition Height="auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="{Binding Date, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}" FontSize="16" FontWeight="Bold"/>
                            <TextBlock Grid.Row="1" Text="{Binding Service.Name}" FontSize="14"/>
                            <TextBlock Grid.Row="2" Text="{Binding User.FIO}" FontSize="14"/>
                            <TextBlock Grid.Row="3" Text="{Binding Dog.Name}" FontSize="14"/>
                            <TextBlock Grid.Row="4" Text="{Binding StatusNote.Name}" FontSize="14"/>
                            <Button x:Name="EditNoteAdmin_Btn" Grid.Row="5" Content="Редактировать"
                            Visibility="{Binding DataContext.AdminEditVisibility, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            Click="EditNoteAdmin_Btn_Click" Width="100" Height="30" Style="{StaticResource addButton3}" HorizontalAlignment="Right"/>
                            <Button x:Name="EditNoteKassir_Btn" Grid.Row="5" Content="Редактировать"
                            Visibility="{Binding DataContext.CashierEditVisibility, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            Click="EditNoteKassir_Btn_Click" Width="100" Height="30" Style="{StaticResource addButton3}" HorizontalAlignment="Right"/>
                            <Button x:Name="EditNoteMaster_Btn" Grid.Row="5" Content="Изменить статус"
                            Visibility="{Binding DataContext.MasterEditVisibility, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            Click="EditNoteMaster_Btn_Click" Width="110" Height="30" Style="{StaticResource addButton3}" HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        <Label Content="Мастер:" HorizontalAlignment="Left" Margin="289,-8,0,0" VerticalAlignment="Top"/>
        <Label Content="Статус:" HorizontalAlignment="Left" Margin="446,-8,0,0" VerticalAlignment="Top"/>
    </Grid>
</UserControl>